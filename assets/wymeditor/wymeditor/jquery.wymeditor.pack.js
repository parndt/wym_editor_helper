if(!WYMeditor)var WYMeditor={};(function(){if(!window.console||!console.firebug){var a=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];WYMeditor.console={};for(var i=0;i<a.length;++i)WYMeditor.console[a[i]]=function(){}}else WYMeditor.console=window.console})();jQuery.extend(WYMeditor,{VERSION:"0.5-b2",INSTANCES:[],STRINGS:[],SKINS:[],NAME:"name",INDEX:"{Wym_Index}",WYM_INDEX:"wym_index",BASE_PATH:"{Wym_Base_Path}",CSS_PATH:"{Wym_Css_Path}",WYM_PATH:"{Wym_Wym_Path}",SKINS_DEFAULT_PATH:"skins/",SKINS_DEFAULT_CSS:"skin.css",SKINS_DEFAULT_JS:"skin.js",LANG_DEFAULT_PATH:"lang/",IFRAME_BASE_PATH:"{Wym_Iframe_Base_Path}",IFRAME_DEFAULT:"iframe/default/",JQUERY_PATH:"{Wym_Jquery_Path}",DIRECTION:"{Wym_Direction}",LOGO:"{Wym_Logo}",TOOLS:"{Wym_Tools}",TOOLS_ITEMS:"{Wym_Tools_Items}",TOOL_NAME:"{Wym_Tool_Name}",TOOL_TITLE:"{Wym_Tool_Title}",TOOL_CLASS:"{Wym_Tool_Class}",CLASSES:"{Wym_Classes}",CLASSES_ITEMS:"{Wym_Classes_Items}",CLASS_NAME:"{Wym_Class_Name}",CLASS_TITLE:"{Wym_Class_Title}",CONTAINERS:"{Wym_Containers}",CONTAINERS_ITEMS:"{Wym_Containers_Items}",CONTAINER_NAME:"{Wym_Container_Name}",CONTAINER_TITLE:"{Wym_Containers_Title}",CONTAINER_CLASS:"{Wym_Container_Class}",HTML:"{Wym_Html}",IFRAME:"{Wym_Iframe}",STATUS:"{Wym_Status}",DIALOG_TITLE:"{Wym_Dialog_Title}",DIALOG_BODY:"{Wym_Dialog_Body}",STRING:"string",BODY:"body",DIV:"div",P:"p",H1:"h1",H2:"h2",H3:"h3",H4:"h4",H5:"h5",H6:"h6",PRE:"pre",BLOCKQUOTE:"blockquote",A:"a",BR:"br",IMG:"img",TABLE:"table",TD:"td",TH:"th",UL:"ul",OL:"ol",LI:"li",CLASS:"class",HREF:"href",SRC:"src",TITLE:"title",ALT:"alt",DIALOG_LINK:"Link",DIALOG_IMAGE:"Image",DIALOG_TABLE:"Table",DIALOG_PASTE:"Paste_From_Word",BOLD:"Bold",ITALIC:"Italic",CREATE_LINK:"CreateLink",INSERT_IMAGE:"InsertImage",INSERT_TABLE:"InsertTable",INSERT_HTML:"InsertHTML",PASTE:"Paste",INDENT:"Indent",OUTDENT:"Outdent",TOGGLE_HTML:"ToggleHtml",FORMAT_BLOCK:"FormatBlock",PREVIEW:"Preview",UNLINK:"Unlink",INSERT_UNORDEREDLIST:"InsertUnorderedList",INSERT_ORDEREDLIST:"InsertOrderedList",MAIN_CONTAINERS:new Array("p","h1","h2","h3","h4","h5","h6","pre","blockquote"),BLOCKS:new Array("address","blockquote","div","dl","fieldset","form","h1","h2","h3","h4","h5","h6","hr","noscript","ol","p","pre","table","ul","dd","dt","li","tbody","td","tfoot","th","thead","tr"),KEY:{BACKSPACE:8,ENTER:13,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,CURSOR:new Array(37,38,39,40),DELETE:46},NODE:{ELEMENT:1,ATTRIBUTE:2,TEXT:3},editor:function(a,b){this._0=WYMeditor.INSTANCES.push(this)-1;this._1=a;this._2=b;this._3=jQuery(a).val();if(this._2.html)this._3=this._2.html;this._2.basePath=this._2.basePath||this.computeBasePath();this._2.skinPath=this._2.skinPath||this._2.basePath+WYMeditor.SKINS_DEFAULT_PATH+this._2.skin+'/';this._2.wymPath=this._2.wymPath||this.computeWymPath();this._2.langPath=this._2.langPath||this._2.basePath+WYMeditor.LANG_DEFAULT_PATH;this._2.iframeBasePath=this._2.iframeBasePath||this._2.basePath+WYMeditor.IFRAME_DEFAULT;this._2.jQueryPath=this._2.jQueryPath||this.computeJqueryPath();this.init()}});jQuery.fn.wymeditor=function(a){a=jQuery.extend({html:"",basePath:false,skinPath:false,wymPath:false,iframeBasePath:false,jQueryPath:false,styles:false,stylesheet:false,skin:"default",initSkin:true,loadSkin:true,lang:"en",direction:"ltr",boxHtml:"<div class='wym_box'>"+"<div class='wym_area_top'>"+WYMeditor.TOOLS+"</div>"+"<div class='wym_area_left'></div>"+"<div class='wym_area_right'>"+WYMeditor.CONTAINERS+WYMeditor.CLASSES+"</div>"+"<div class='wym_area_main'>"+WYMeditor.HTML+WYMeditor.IFRAME+WYMeditor.STATUS+"</div>"+"<div class='wym_area_bottom'>"+WYMeditor.LOGO+"</div>"+"</div>",logoHtml:"<a class='wym_wymeditor_link' "+"href='http://www.wymeditor.org/'>WYMeditor</a>",iframeHtml:"<div class='wym_iframe wym_section'>"+"<iframe "+"src='"+WYMeditor.IFRAME_BASE_PATH+"wymiframe.html' "+"onload='this.contentWindow.parent.WYMeditor.INSTANCES["+WYMeditor.INDEX+"].initIframe(this)'"+"></iframe>"+"</div>",editorStyles:[],toolsHtml:"<div class='wym_tools wym_section'>"+"<h2>{Tools}</h2>"+"<ul>"+WYMeditor.TOOLS_ITEMS+"</ul>"+"</div>",toolsItemHtml:"<li class='"+WYMeditor.TOOL_CLASS+"'><a href='#' name='"+WYMeditor.TOOL_NAME+"' title='"+WYMeditor.TOOL_TITLE+"'>"+WYMeditor.TOOL_TITLE+"</a></li>",toolsItems:[{'name':'Bold','title':'Strong','css':'wym_tools_strong'},{'name':'Italic','title':'Emphasis','css':'wym_tools_emphasis'},{'name':'Superscript','title':'Superscript','css':'wym_tools_superscript'},{'name':'Subscript','title':'Subscript','css':'wym_tools_subscript'},{'name':'InsertOrderedList','title':'Ordered_List','css':'wym_tools_ordered_list'},{'name':'InsertUnorderedList','title':'Unordered_List','css':'wym_tools_unordered_list'},{'name':'Indent','title':'Indent','css':'wym_tools_indent'},{'name':'Outdent','title':'Outdent','css':'wym_tools_outdent'},{'name':'Undo','title':'Undo','css':'wym_tools_undo'},{'name':'Redo','title':'Redo','css':'wym_tools_redo'},{'name':'CreateLink','title':'Link','css':'wym_tools_link'},{'name':'Unlink','title':'Unlink','css':'wym_tools_unlink'},{'name':'InsertImage','title':'Image','css':'wym_tools_image'},{'name':'InsertTable','title':'Table','css':'wym_tools_table'},{'name':'Paste','title':'Paste_From_Word','css':'wym_tools_paste'},{'name':'ToggleHtml','title':'HTML','css':'wym_tools_html'},{'name':'Preview','title':'Preview','css':'wym_tools_preview'}],containersHtml:"<div class='wym_containers wym_section'>"+"<h2>{Containers}</h2>"+"<ul>"+WYMeditor.CONTAINERS_ITEMS+"</ul>"+"</div>",containersItemHtml:"<li class='"+WYMeditor.CONTAINER_CLASS+"'>"+"<a href='#' name='"+WYMeditor.CONTAINER_NAME+"'>"+WYMeditor.CONTAINER_TITLE+"</a></li>",containersItems:[{'name':'P','title':'Paragraph','css':'wym_containers_p'},{'name':'H1','title':'Heading_1','css':'wym_containers_h1'},{'name':'H2','title':'Heading_2','css':'wym_containers_h2'},{'name':'H3','title':'Heading_3','css':'wym_containers_h3'},{'name':'H4','title':'Heading_4','css':'wym_containers_h4'},{'name':'H5','title':'Heading_5','css':'wym_containers_h5'},{'name':'H6','title':'Heading_6','css':'wym_containers_h6'},{'name':'PRE','title':'Preformatted','css':'wym_containers_pre'},{'name':'BLOCKQUOTE','title':'Blockquote','css':'wym_containers_blockquote'},{'name':'TH','title':'Table_Header','css':'wym_containers_th'}],classesHtml:"<div class='wym_classes wym_section'>"+"<h2>{Classes}</h2><ul>"+WYMeditor.CLASSES_ITEMS+"</ul></div>",classesItemHtml:"<li><a href='#' name='"+WYMeditor.CLASS_NAME+"'>"+WYMeditor.CLASS_TITLE+"</a></li>",classesItems:[],statusHtml:"<div class='wym_status wym_section'>"+"<h2>{Status}</h2>"+"</div>",htmlHtml:"<div class='wym_html wym_section'>"+"<h2>{Source_Code}</h2>"+"<textarea class='wym_html_val'></textarea>"+"</div>",boxSelector:".wym_box",toolsSelector:".wym_tools",toolsListSelector:" ul",containersSelector:".wym_containers",classesSelector:".wym_classes",htmlSelector:".wym_html",iframeSelector:".wym_iframe iframe",iframeBodySelector:".wym_iframe",statusSelector:".wym_status",toolSelector:".wym_tools a",containerSelector:".wym_containers a",classSelector:".wym_classes a",htmlValSelector:".wym_html_val",hrefSelector:".wym_href",srcSelector:".wym_src",titleSelector:".wym_title",altSelector:".wym_alt",textSelector:".wym_text",rowsSelector:".wym_rows",colsSelector:".wym_cols",captionSelector:".wym_caption",summarySelector:".wym_summary",submitSelector:".wym_submit",cancelSelector:".wym_cancel",previewSelector:"",dialogTypeSelector:".wym_dialog_type",dialogLinkSelector:".wym_dialog_link",dialogImageSelector:".wym_dialog_image",dialogTableSelector:".wym_dialog_table",dialogPasteSelector:".wym_dialog_paste",dialogPreviewSelector:".wym_dialog_preview",updateSelector:".wymupdate",updateEvent:"click",dialogFeatures:"menubar=no,titlebar=no,toolbar=no,resizable=no"+",width=560,height=300,top=0,left=0",dialogHtml:"<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Strict//EN'"+" 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'>"+"<html dir='"+WYMeditor.DIRECTION+"'><head>"+"<link rel='stylesheet' type='text/css' media='screen'"+" href='"+WYMeditor.CSS_PATH+"' />"+"<title>"+WYMeditor.DIALOG_TITLE+"</title>"+"<script type='text/javascript'"+" src='"+WYMeditor.JQUERY_PATH+"'></script>"+"<script type='text/javascript'"+" src='"+WYMeditor.WYM_PATH+"'></script>"+"</head>"+WYMeditor.DIALOG_BODY+"</html>",dialogLinkHtml:"<body class='wym_dialog wym_dialog_link'"+" onload='WYMeditor.INIT_DIALOG("+WYMeditor.INDEX+")'"+">"+"<form>"+"<fieldset>"+"<input type='hidden' class='wym_dialog_type' value='"+WYMeditor.DIALOG_LINK+"' />"+"<legend>{Link}</legend>"+"<div class='row'>"+"<label>{URL}</label>"+"<input type='text' class='wym_href' value='' size='40' />"+"</div>"+"<div class='row'>"+"<label>{Title}</label>"+"<input type='text' class='wym_title' value='' size='40' />"+"</div>"+"<div class='row row-indent'>"+"<input class='wym_submit' type='button'"+" value='{Submit}' />"+"<input class='wym_cancel' type='button'"+"value='{Cancel}' />"+"</div>"+"</fieldset>"+"</form>"+"</body>",dialogImageHtml:"<body class='wym_dialog wym_dialog_image'"+" onload='WYMeditor.INIT_DIALOG("+WYMeditor.INDEX+")'"+">"+"<form>"+"<fieldset>"+"<input type='hidden' class='wym_dialog_type' value='"+WYMeditor.DIALOG_IMAGE+"' />"+"<legend>{Image}</legend>"+"<div class='row'>"+"<label>{URL}</label>"+"<input type='text' class='wym_src' value='' size='40' />"+"</div>"+"<div class='row'>"+"<label>{Alternative_Text}</label>"+"<input type='text' class='wym_alt' value='' size='40' />"+"</div>"+"<div class='row'>"+"<label>{Title}</label>"+"<input type='text' class='wym_title' value='' size='40' />"+"</div>"+"<div class='row row-indent'>"+"<input class='wym_submit' type='button'"+" value='{Submit}' />"+"<input class='wym_cancel' type='button'"+"value='{Cancel}' />"+"</div>"+"</fieldset>"+"</form>"+"</body>",dialogTableHtml:"<body class='wym_dialog wym_dialog_table'"+" onload='WYMeditor.INIT_DIALOG("+WYMeditor.INDEX+")'"+">"+"<form>"+"<fieldset>"+"<input type='hidden' class='wym_dialog_type' value='"+WYMeditor.DIALOG_TABLE+"' />"+"<legend>{Table}</legend>"+"<div class='row'>"+"<label>{Caption}</label>"+"<input type='text' class='wym_caption' value='' size='40' />"+"</div>"+"<div class='row'>"+"<label>{Summary}</label>"+"<input type='text' class='wym_summary' value='' size='40' />"+"</div>"+"<div class='row'>"+"<label>{Number_Of_Rows}</label>"+"<input type='text' class='wym_rows' value='3' size='3' />"+"</div>"+"<div class='row'>"+"<label>{Number_Of_Cols}</label>"+"<input type='text' class='wym_cols' value='2' size='3' />"+"</div>"+"<div class='row row-indent'>"+"<input class='wym_submit' type='button'"+" value='{Submit}' />"+"<input class='wym_cancel' type='button'"+"value='{Cancel}' />"+"</div>"+"</fieldset>"+"</form>"+"</body>",dialogPasteHtml:"<body class='wym_dialog wym_dialog_paste'"+" onload='WYMeditor.INIT_DIALOG("+WYMeditor.INDEX+")'"+">"+"<form>"+"<input type='hidden' class='wym_dialog_type' value='"+WYMeditor.DIALOG_PASTE+"' />"+"<fieldset>"+"<legend>{Paste_From_Word}</legend>"+"<div class='row'>"+"<textarea class='wym_text' rows='10' cols='50'></textarea>"+"</div>"+"<div class='row'>"+"<input class='wym_submit' type='button'"+" value='{Submit}' />"+"<input class='wym_cancel' type='button'"+"value='{Cancel}' />"+"</div>"+"</fieldset>"+"</form>"+"</body>",dialogPreviewHtml:"<body class='wym_dialog wym_dialog_preview'"+" onload='WYMeditor.INIT_DIALOG("+WYMeditor.INDEX+")'"+"></body>",dialogStyles:[],stringDelimiterLeft:"{",stringDelimiterRight:"}",preInit:null,preBind:null,postInit:null,preInitDialog:null,postInitDialog:null},a);return this.each(function(){new WYMeditor.editor(jQuery(this),a)})};jQuery.extend({wymeditors:function(i){return(WYMeditor.INSTANCES[i])}});WYMeditor.editor.prototype.init=function(){if(jQuery.browser.msie){var a=new WYMeditor.WymClassExplorer(this)}else if(jQuery.browser.mozilla){var a=new WYMeditor.WymClassMozilla(this)}else if(jQuery.browser.opera){var a=new WYMeditor.WymClassOpera(this)}else if(jQuery.browser.safari){var a=new WYMeditor.WymClassSafari(this)}if(a){if(jQuery.isFunction(this._2.preInit))this._2.preInit(this);var b=new WYMeditor.XhtmlSaxListener();jQuery.extend(b,a);this.parser=new WYMeditor.XhtmlParser(b);if(this._2.styles||this._2.stylesheet){this.configureEditorUsingRawCss()}this.helper=new WYMeditor.XmlHelper();for(var c in a){this[c]=a[c]}this._4=jQuery(this._1).hide().after(this._2.boxHtml).next();if(jQuery.isFunction(jQuery.fn.data))jQuery.data(this._4.get(0),WYMeditor.WYM_INDEX,this._0);var h=WYMeditor.Helper;var d=this._2.iframeHtml;d=h.replaceAll(d,WYMeditor.INDEX,this._0);d=h.replaceAll(d,WYMeditor.IFRAME_BASE_PATH,this._2.iframeBasePath);var e=jQuery(this._4).html();e=h.replaceAll(e,WYMeditor.LOGO,this._2.logoHtml);e=h.replaceAll(e,WYMeditor.TOOLS,this._2.toolsHtml);e=h.replaceAll(e,WYMeditor.CONTAINERS,this._2.containersHtml);e=h.replaceAll(e,WYMeditor.CLASSES,this._2.classesHtml);e=h.replaceAll(e,WYMeditor.HTML,this._2.htmlHtml);e=h.replaceAll(e,WYMeditor.IFRAME,d);e=h.replaceAll(e,WYMeditor.STATUS,this._2.statusHtml);var f=eval(this._2.toolsItems);var g="";for(var i=0;i<f.length;i++){var j=f[i];if(j.name&&j.title)var k=this._2.toolsItemHtml;var k=h.replaceAll(k,WYMeditor.TOOL_NAME,j.name);k=h.replaceAll(k,WYMeditor.TOOL_TITLE,this._2.stringDelimiterLeft+j.title+this._2.stringDelimiterRight);k=h.replaceAll(k,WYMeditor.TOOL_CLASS,j.css);g+=k}e=h.replaceAll(e,WYMeditor.TOOLS_ITEMS,g);var l=eval(this._2.classesItems);var m="";for(var i=0;i<l.length;i++){var n=l[i];if(n.name&&n.title)var o=this._2.classesItemHtml;o=h.replaceAll(o,WYMeditor.CLASS_NAME,n.name);o=h.replaceAll(o,WYMeditor.CLASS_TITLE,n.title);m+=o}e=h.replaceAll(e,WYMeditor.CLASSES_ITEMS,m);var p=eval(this._2.containersItems);var q="";for(var i=0;i<p.length;i++){var r=p[i];if(r.name&&r.title)var s=this._2.containersItemHtml;s=h.replaceAll(s,WYMeditor.CONTAINER_NAME,r.name);s=h.replaceAll(s,WYMeditor.CONTAINER_TITLE,this._2.stringDelimiterLeft+r.title+this._2.stringDelimiterRight);s=h.replaceAll(s,WYMeditor.CONTAINER_CLASS,r.css);q+=s}e=h.replaceAll(e,WYMeditor.CONTAINERS_ITEMS,q);e=this.replaceStrings(e);jQuery(this._4).html(e);jQuery(this._4).find(this._2.htmlSelector).hide();this.loadSkin()}};WYMeditor.editor.prototype.bindEvents=function(){var e=this;jQuery(this._4).find(this._2.toolSelector).click(function(){e.exec(jQuery(this).attr(WYMeditor.NAME));return(false)});jQuery(this._4).find(this._2.containerSelector).click(function(){e.container(jQuery(this).attr(WYMeditor.NAME));return(false)});jQuery(this._4).find(this._2.htmlValSelector).keyup(function(){jQuery(e._5.body).html(jQuery(this).val())});jQuery(this._4).find(this._2.classSelector).click(function(){var a=eval(e._2.classesItems);var b=jQuery(this).attr(WYMeditor.NAME);var c=WYMeditor.Helper.findByName(a,b);if(c){var d=c.expr;e.toggleClass(b,d)}return(false)});jQuery(this._2.updateSelector).bind(this._2.updateEvent,function(){e.update()})};WYMeditor.editor.prototype.ready=function(){return(this._5!=null)};WYMeditor.editor.prototype.box=function(){return(this._4)};WYMeditor.editor.prototype.html=function(a){if(typeof a==='string')jQuery(this._5.body).html(a);else return(jQuery(this._5.body).html())};WYMeditor.editor.prototype.xhtml=function(){return this.parser.parse(this.html())};WYMeditor.editor.prototype.exec=function(a){switch(a){case WYMeditor.CREATE_LINK:var b=this.container();if(b||this._6)this.dialog(WYMeditor.DIALOG_LINK);break;case WYMeditor.INSERT_IMAGE:this.dialog(WYMeditor.DIALOG_IMAGE);break;case WYMeditor.INSERT_TABLE:this.dialog(WYMeditor.DIALOG_TABLE);break;case WYMeditor.PASTE:this.dialog(WYMeditor.DIALOG_PASTE);break;case WYMeditor.TOGGLE_HTML:this.update();this.toggleHtml();if(!jQuery(this._4).find(this._2.htmlSelector).is(':visible'))this.listen();break;case WYMeditor.PREVIEW:this.dialog(WYMeditor.PREVIEW);break;default:this._7(a);break}};WYMeditor.editor.prototype.container=function(a){if(a){var b=null;if(a.toLowerCase()==WYMeditor.TH){b=this.container();switch(b.tagName.toLowerCase()){case WYMeditor.TD:case WYMeditor.TH:break;default:var c=new Array(WYMeditor.TD,WYMeditor.TH);b=this.findUp(this.container(),c);break}if(b!=null){a=(b.tagName.toLowerCase()==WYMeditor.TD)?WYMeditor.TH:WYMeditor.TD;this.switchTo(b,a);this.update()}}else{var c=new Array(WYMeditor.P,WYMeditor.H1,WYMeditor.H2,WYMeditor.H3,WYMeditor.H4,WYMeditor.H5,WYMeditor.H6,WYMeditor.PRE,WYMeditor.BLOCKQUOTE);b=this.findUp(this.container(),c);if(b){var d=null;if(a.toLowerCase()==WYMeditor.BLOCKQUOTE){var e=this.findUp(this.container(),WYMeditor.BLOCKQUOTE);if(e==null){d=this._5.createElement(a);b.parentNode.insertBefore(d,b);d.appendChild(b);this.setFocusToNode(d.firstChild)}else{var f=e.childNodes;var g=f.length;var h=null;if(g>0)h=f.item(0);for(var x=0;x<g;x++){e.parentNode.insertBefore(f.item(0),e)}e.parentNode.removeChild(e);if(h)this.setFocusToNode(h)}}else this.switchTo(b,a);this.update()}}}else return(this.selected())};WYMeditor.editor.prototype.toggleClass=function(a,b){var c=(this._6?this._6:jQuery(this.selected()));c=jQuery(c).parentsOrSelf(b);jQuery(c).toggleClass(a);if(!jQuery(c).attr(WYMeditor.CLASS))jQuery(c).removeAttr(this._8)};WYMeditor.editor.prototype.findUp=function(a,b){if(a){var c=a.tagName.toLowerCase();if(typeof(b)==WYMeditor.STRING){while(c!=b&&c!=WYMeditor.BODY){a=a.parentNode;c=a.tagName.toLowerCase()}}else{var d=false;while(!d&&c!=WYMeditor.BODY){for(var i=0;i<b.length;i++){if(c==b[i]){d=true;break}}if(!d){a=a.parentNode;c=a.tagName.toLowerCase()}}}if(c!=WYMeditor.BODY)return(a);else return(null)}else return(null)};WYMeditor.editor.prototype.switchTo=function(a,b){var c=this._5.createElement(b);var d=jQuery(a).html();a.parentNode.replaceChild(c,a);jQuery(c).html(d);this.setFocusToNode(c)};WYMeditor.editor.prototype.replaceStrings=function(a){if(!WYMeditor.STRINGS[this._2.lang]){try{eval(jQuery.ajax({url:this._2.langPath+this._2.lang+'.js',async:false}).responseText)}catch(e){WYMeditor.console.error("WYMeditor: error while parsing language file.");return a}}for(var b in WYMeditor.STRINGS[this._2.lang]){a=WYMeditor.Helper.replaceAll(a,this._2.stringDelimiterLeft+b+this._2.stringDelimiterRight,WYMeditor.STRINGS[this._2.lang][b])};return(a)};WYMeditor.editor.prototype.encloseString=function(a){return(this._2.stringDelimiterLeft+a+this._2.stringDelimiterRight)};WYMeditor.editor.prototype.status=function(a){jQuery(this._4).find(this._2.statusSelector).html(a)};WYMeditor.editor.prototype.update=function(){var a=this.xhtml();jQuery(this._1).val(a);jQuery(this._4).find(this._2.htmlValSelector).val(a)};WYMeditor.editor.prototype.dialog=function(a,b){var c=window.open('','dialog',this._9._2.dialogFeatures);if(c){var d="";switch(a){case(WYMeditor.DIALOG_LINK):d=this._2.dialogLinkHtml;break;case(WYMeditor.DIALOG_IMAGE):d=this._2.dialogImageHtml;break;case(WYMeditor.DIALOG_TABLE):d=this._2.dialogTableHtml;break;case(WYMeditor.DIALOG_PASTE):d=this._2.dialogPasteHtml;break;case(WYMeditor.PREVIEW):d=this._2.dialogPreviewHtml;break;default:d=b}var h=WYMeditor.Helper;var e=this._2.dialogHtml;e=h.replaceAll(e,WYMeditor.BASE_PATH,this._2.basePath);e=h.replaceAll(e,WYMeditor.DIRECTION,this._2.direction);e=h.replaceAll(e,WYMeditor.CSS_PATH,this._2.skinPath+WYMeditor.SKINS_DEFAULT_CSS);e=h.replaceAll(e,WYMeditor.WYM_PATH,this._2.wymPath);e=h.replaceAll(e,WYMeditor.JQUERY_PATH,this._2.jQueryPath);e=h.replaceAll(e,WYMeditor.DIALOG_TITLE,this.encloseString(a));e=h.replaceAll(e,WYMeditor.DIALOG_BODY,d);e=h.replaceAll(e,WYMeditor.INDEX,this._0);e=this.replaceStrings(e);var f=c.document;f.write(e);f.close()}};WYMeditor.editor.prototype.toggleHtml=function(){jQuery(this._4).find(this._2.htmlSelector).toggle()};WYMeditor.editor.prototype.uniqueStamp=function(){var a=new Date();return("wym-"+a.getTime())};WYMeditor.editor.prototype.paste=function(a){var b;var c=this.selected();var d=a.split(this._10+this._10);var e=new RegExp(this._10,"g");if(c&&c.tagName.toLowerCase()!=WYMeditor.BODY){for(x=d.length-1;x>=0;x--){b=d[x];b=b.replace(e,"<br />");jQuery(c).after("<p>"+b+"</p>")}}else{for(x=0;x<d.length;x++){b=d[x];b=b.replace(e,"<br />");jQuery(this._5.body).append("<p>"+b+"</p>")}}};WYMeditor.editor.prototype.insert=function(a){if(this._11.contentWindow.getSelection().focusNode!=null){this._7(WYMeditor.INSERT_HTML,a)}else{this.paste(a)}};WYMeditor.editor.prototype.wrap=function(a,b){if(this._11.contentWindow.getSelection().focusNode!=null){this._7(WYMeditor.INSERT_HTML,a+this._11.contentWindow.getSelection().toString()+b)}};WYMeditor.editor.prototype.unwrap=function(){if(this._11.contentWindow.getSelection().focusNode!=null){this._7(WYMeditor.INSERT_HTML,this._11.contentWindow.getSelection().toString())}};WYMeditor.editor.prototype.addCssRules=function(a,b){var c=a.styleSheets[0];if(c){for(var i=0;i<b.length;i++){var d=b[i];if(d.name&&d.css)this.addCssRule(c,d)}}};WYMeditor.editor.prototype.computeBasePath=function(){return jQuery(jQuery.grep(jQuery('script'),function(s){return(s.src&&s.src.match(/jquery\.wymeditor(\.pack){0,1}\.js(\?.*)?$/))})).attr('src').replace(/jquery\.wymeditor(\.pack){0,1}\.js(\?.*)?$/,'')};WYMeditor.editor.prototype.computeWymPath=function(){return jQuery(jQuery.grep(jQuery('script'),function(s){return(s.src&&s.src.match(/jquery\.wymeditor(\.pack){0,1}\.js(\?.*)?$/))})).attr('src')};WYMeditor.editor.prototype.computeJqueryPath=function(){return jQuery(jQuery.grep(jQuery('script'),function(s){return(s.src&&s.src.match(/jquery(-(.*)){0,1}(\.pack){0,1}\.js(\?.*)?$/))})).attr('src')};WYMeditor.editor.prototype.computeCssPath=function(){return jQuery(jQuery.grep(jQuery('link'),function(s){return(s.href&&s.href.match(/wymeditor\/skins\/(.*)screen\.css(\?.*)?$/))})).attr('href')};WYMeditor.editor.prototype.configureEditorUsingRawCss=function(){var a=new WYMeditor.WymCssParser();if(this._2.stylesheet){a.parse(jQuery.ajax({url:this._2.stylesheet,async:false}).responseText)}else{a.parse(this._2.styles,false)}if(this._2.classesItems.length==0){this._2.classesItems=a.css_settings.classesItems}if(this._2.editorStyles.length==0){this._2.editorStyles=a.css_settings.editorStyles}if(this._2.dialogStyles.length==0){this._2.dialogStyles=a.css_settings.dialogStyles}};WYMeditor.editor.prototype.listen=function(){jQuery(this._5.body).bind("mousedown",this.mousedown);var a=this._5.body.getElementsByTagName("img");for(var i=0;i<a.length;i++){jQuery(a[i]).bind("mousedown",this.mousedown)}};WYMeditor.editor.prototype.mousedown=function(a){var b=WYMeditor.INSTANCES[this.ownerDocument.title];b._6=(this.tagName.toLowerCase()==WYMeditor.IMG)?this:null;a.stopPropagation()};WYMeditor.loadCss=function(a){var b=document.createElement('link');b.rel='stylesheet';b.href=a;var c=jQuery('head').get(0);c.appendChild(b)};WYMeditor.editor.prototype.loadSkin=function(){if(this._2.loadSkin&&!WYMeditor.SKINS[this._2.skin]){var a=false;var b=new RegExp(this._2.skin+'\/'+WYMeditor.SKINS_DEFAULT_CSS+'$');jQuery('link').each(function(){if(this.href.match(b))a=true});if(!a)WYMeditor.loadCss(this._2.skinPath+WYMeditor.SKINS_DEFAULT_CSS)}jQuery(this._4).addClass("wym_skin_"+this._2.skin);if(this._2.initSkin&&!WYMeditor.SKINS[this._2.skin]){eval(jQuery.ajax({url:this._2.skinPath+WYMeditor.SKINS_DEFAULT_JS,async:false}).responseText)}if(WYMeditor.SKINS[this._2.skin]&&WYMeditor.SKINS[this._2.skin].init)WYMeditor.SKINS[this._2.skin].init(this)};WYMeditor.INIT_DIALOG=function(i){var j=window.opener.WYMeditor.INSTANCES[i];var k=window.document;var l=j.selected();var m=jQuery(j._2.dialogTypeSelector).val();var n=j.uniqueStamp();switch(m){case WYMeditor.DIALOG_LINK:if(l&&l.tagName&&l.tagName.toLowerCase!=WYMeditor.A)l=jQuery(l).parentsOrSelf(WYMeditor.A);if(!l&&j._6)l=jQuery(j._6).parentsOrSelf(WYMeditor.A);break}if(jQuery.isFunction(j._2.preInitDialog))j._2.preInitDialog(j,window);var o=k.styleSheets[0];var p=eval(j._2.dialogStyles);j.addCssRules(k,p);if(l){jQuery(j._2.hrefSelector).val(jQuery(l).attr(WYMeditor.HREF));jQuery(j._2.srcSelector).val(jQuery(l).attr(WYMeditor.SRC));jQuery(j._2.titleSelector).val(jQuery(l).attr(WYMeditor.TITLE));jQuery(j._2.altSelector).val(jQuery(l).attr(WYMeditor.ALT))}if(j._6){jQuery(j._2.dialogImageSelector+" "+j._2.srcSelector).val(jQuery(j._6).attr(WYMeditor.SRC));jQuery(j._2.dialogImageSelector+" "+j._2.titleSelector).val(jQuery(j._6).attr(WYMeditor.TITLE));jQuery(j._2.dialogImageSelector+" "+j._2.altSelector).val(jQuery(j._6).attr(WYMeditor.ALT))}jQuery(j._2.dialogLinkSelector+" "+j._2.submitSelector).click(function(){var a=jQuery(j._2.hrefSelector).val();if(a.length>0){j._7(WYMeditor.CREATE_LINK,n);jQuery("a[@href="+n+"]",j._5.body).attr(WYMeditor.HREF,a).attr(WYMeditor.TITLE,jQuery(j._2.titleSelector).val())}window.close()});jQuery(j._2.dialogImageSelector+" "+j._2.submitSelector).click(function(){var a=jQuery(j._2.srcSelector).val();if(a.length>0){j._7(WYMeditor.INSERT_IMAGE,n);jQuery("img[@src="+n+"]",j._5.body).attr(WYMeditor.SRC,a).attr(WYMeditor.TITLE,jQuery(j._2.titleSelector).val()).attr(WYMeditor.ALT,jQuery(j._2.altSelector).val())}window.close()});jQuery(j._2.dialogTableSelector+" "+j._2.submitSelector).click(function(){var a=jQuery(j._2.rowsSelector).val();var b=jQuery(j._2.colsSelector).val();if(a>0&&b>0){var c=j._5.createElement(WYMeditor.TABLE);var d=null;var e=null;var f=jQuery(j._2.captionSelector).val();var g=c.createCaption();g.innerHTML=f;for(x=0;x<a;x++){d=c.insertRow(x);for(y=0;y<b;y++){d.insertCell(y)}}jQuery(c).attr('summary',jQuery(j._2.summarySelector).val());var h=jQuery(j.findUp(j.container(),WYMeditor.MAIN_CONTAINERS)).get(0);if(!h||!h.parentNode)jQuery(j._5.body).append(c);else jQuery(h).after(c)}window.close()});jQuery(j._2.dialogPasteSelector+" "+j._2.submitSelector).click(function(){var a=jQuery(j._2.textSelector).val();j.paste(a);window.close()});jQuery(j._2.dialogPreviewSelector+" "+j._2.previewSelector).html(j.xhtml());jQuery(j._2.cancelSelector).mousedown(function(){window.close()});if(jQuery.isFunction(j._2.postInitDialog))j._2.postInitDialog(j,window)};WYMeditor.XmlHelper=function(){this._12=document.createElement('div');return this};WYMeditor.XmlHelper.prototype.tag=function(a,b,c){b=b||false;c=c||false;return'<'+a+(b?this.tagOptions(b):'')+(c?'>':' />')};WYMeditor.XmlHelper.prototype.contentTag=function(a,b,c){c=c||false;return'<'+a+(c?this.tagOptions(c):'')+'>'+b+'</'+a+'>'};WYMeditor.XmlHelper.prototype.cdataSection=function(a){return'<![CDATA['+a+']]>'};WYMeditor.XmlHelper.prototype.escapeOnce=function(a){return this._13(this.escapeEntities(a))};WYMeditor.XmlHelper.prototype._13=function(a){return a.replace(/&amp;([a-z]+|(#\d+));/ig,"&$1;")};WYMeditor.XmlHelper.prototype.tagOptions=function(a){var b=this;b._14='';for(var c in a){var d='';var e=a[c];if(typeof e!='function'&&e.length>0){if(parseInt(c)==c&&typeof e=='object'){c=e.shift();e=e.pop()}if(c!=''&&e!=''){b._14+=' '+c+'="'+b.escapeOnce(e)+'"'}}}return b._14};WYMeditor.XmlHelper.prototype.escapeEntities=function(a,b){this._12.innerHTML=a;this._12.textContent=a;var c=this._12.innerHTML;if(typeof b=='undefined'){if(b!=false)c=c.replace('"','&quot;');if(b==true)c=c.replace('"','&#039;')}return c};WYMeditor.XmlHelper.prototype.parseAttributes=function(a){var b=[];var c=a.split(/((=\s*")(")("))|((=\s*\')(\')(\'))|((=\s*[^>\s]*))/g);if(c.toString()!=a){for(var k in c){var v=c[k];if(typeof v!='function'&&v.length!=0){var d=new RegExp('(\\w+)\\s*'+v);if(match=a.match(d)){var e=v.replace(/^[\s=]+/,"");var f=e.charAt(0);f=f=='"'?'"':(f=="'"?"'":'');if(f!=''){e=f=='"'?e.replace(/^"|"+$/g,''):e.replace(/^'|'+$/g,'')}a=a.replace(match[0],'');b.push([match[1],e])}}}}return b};WYMeditor.XhtmlValidator={"_15":{"core":{"except":["base","head","html","meta","param","script","style","title"],"attributes":["class","id","style","title","accesskey","tabindex"]},"language":{"except":["base","br","hr","iframe","param","script"],"attributes":{"dir":["ltr","rtl"],"0":"lang","1":"xml:lang"}},"keyboard":{"attributes":{"accesskey":/^(\w){1}$/,"tabindex":/^(\d)+$/}}},"_16":{"window":{"only":["body"],"attributes":["onload","onunload"]},"form":{"only":["form","input","textarea","select","a","label","button"],"attributes":["onchange","onsubmit","onreset","onselect","onblur","onfocus"]},"keyboard":{"except":["base","bdo","br","frame","frameset","head","html","iframe","meta","param","script","style","title"],"attributes":["onkeydown","onkeypress","onkeyup"]},"mouse":{"except":["base","bdo","br","head","html","meta","param","script","style","title"],"attributes":["onclick","ondblclick","onmousedown","onmousemove","onmouseover","onmouseout","onmouseup"]}},"_17":{"a":{"attributes":{"0":"charset","1":"coords","2":"href","3":"hreflang","4":"name","rel":/^(alternate|designates|stylesheet|start|next|prev|contents|index|glossary|copyright|chapter|section|subsection|appendix|help|bookmark| |shortcut|icon)+$/,"rev":/^(alternate|designates|stylesheet|start|next|prev|contents|index|glossary|copyright|chapter|section|subsection|appendix|help|bookmark| |shortcut|icon)+$/,"shape":/^(rect|rectangle|circ|circle|poly|polygon)$/,"5":"type","target":/^(_18)+$/}},"0":"abbr","1":"acronym","2":"address","area":{"attributes":{"0":"alt","1":"coords","2":"href","nohref":/^(true|false)$/,"shape":/^(rect|rectangle|circ|circle|poly|polygon)$/},"required":["alt"]},"3":"b","base":{"attributes":["href"],"required":["href"]},"bdo":{"attributes":{"dir":/^(ltr|rtl)$/},"required":["dir"]},"4":"big","blockquote":{"attributes":["cite"]},"5":"body","6":"br","button":{"attributes":{"disabled":/^(disabled)$/,"type":/^(button|reset|submit)$/,"0":"value"},"inside":"form"},"7":"caption","8":"cite","9":"code","col":{"attributes":{"align":/^(right|left|center|justify)$/,"0":"char","1":"charoff","span":/^(\d)+$/,"valign":/^(top|middle|bottom|baseline)$/,"2":"width"},"inside":"colgroup"},"colgroup":{"attributes":{"align":/^(right|left|center|justify)$/,"0":"char","1":"charoff","span":/^(\d)+$/,"valign":/^(top|middle|bottom|baseline)$/,"2":"width"}},"10":"dd","del":{"attributes":{"0":"cite","datetime":/^([0-9]){8}/}},"11":"div","12":"dfn","13":"dl","14":"dt","15":"em","embed":{"attributes":["allowscriptaccess","allowfullscreen","height","src","type","width"]},"fieldset":{"inside":"form"},"form":{"attributes":{"0":"action","1":"accept","2":"accept-charset","3":"enctype","method":/^(get|post)$/},"required":["action"]},"head":{"attributes":["profile"]},"16":"h1","17":"h2","18":"h3","19":"h4","20":"h5","21":"h6","22":"hr","html":{"attributes":["xmlns"]},"23":"i","img":{"attributes":["alt","src","height","ismap","longdesc","usemap","width"],"required":["alt","src"]},"input":{"attributes":{"0":"accept","1":"alt","checked":/^(checked)$/,"disabled":/^(disabled)$/,"maxlength":/^(\d)+$/,"2":"name","readonly":/^(readonly)$/,"size":/^(\d)+$/,"3":"src","type":/^(button|checkbox|file|hidden|image|password|radio|reset|submit|text)$/,"4":"value"},"inside":"form"},"ins":{"attributes":{"0":"cite","datetime":/^([0-9]){8}/}},"24":"kbd","label":{"attributes":["for"],"inside":"form"},"25":"legend","26":"li","link":{"attributes":{"0":"charset","1":"href","2":"hreflang","media":/^(all|braille|print|projection|screen|speech|,|;| )+$/i,"rel":/^(alternate|appendix|bookmark|chapter|contents|copyright|glossary|help|home|index|next|prev|section|start|stylesheet|subsection| |shortcut|icon)+$/i,"rev":/^(alternate|appendix|bookmark|chapter|contents|copyright|glossary|help|home|index|next|prev|section|start|stylesheet|subsection| |shortcut|icon)+$/i,"3":"type"},"inside":"head"},"map":{"attributes":["id","name"],"required":["id"]},"meta":{"attributes":{"0":"content","http-equiv":/^(content\-type|expires|refresh|set\-cookie)$/i,"1":"name","2":"scheme"},"required":["content"]},"27":"noscript","object":{"attributes":["archive","classid","codebase","codetype","data","declare","height","name","standby","type","usemap","width"]},"28":"ol","optgroup":{"attributes":{"0":"label","disabled":/^(disabled)$/},"required":["label"]},"option":{"attributes":{"0":"label","disabled":/^(disabled)$/,"selected":/^(selected)$/,"1":"value"},"inside":"select"},"29":"p","param":{"attributes":{"0":"name","1":"type","valuetype":/^(data|ref|object)$/,"2":"valuetype","3":"value"},"required":["name"]},"30":"pre","q":{"attributes":["cite"]},"31":"samp","script":{"attributes":{"type":/^(text\/ecmascript|text\/javascript|text\/jscript|text\/vbscript|text\/vbs|text\/xml)$/,"0":"charset","defer":/^(defer)$/,"1":"src"},"required":["type"]},"select":{"attributes":{"disabled":/^(disabled)$/,"multiple":/^(multiple)$/,"0":"name","1":"size"},"inside":"form"},"32":"small","33":"span","34":"strong","style":{"attributes":{"0":"type","media":/^(screen|tty|tv|projection|handheld|print|braille|aural|all)$/},"required":["type"]},"35":"sub","36":"sup","table":{"attributes":{"0":"border","1":"cellpadding","2":"cellspacing","frame":/^(void|above|below|hsides|lhs|rhs|vsides|box|border)$/,"rules":/^(none|groups|rows|cols|all)$/,"3":"summary","4":"width"}},"tbody":{"attributes":{"align":/^(right|left|center|justify)$/,"0":"char","1":"charoff","valign":/^(top|middle|bottom|baseline)$/}},"td":{"attributes":{"0":"abbr","align":/^(left|right|center|justify|char)$/,"1":"axis","2":"char","3":"charoff","colspan":/^(\d)+$/,"4":"headers","rowspan":/^(\d)+$/,"scope":/^(col|colgroup|row|rowgroup)$/,"valign":/^(top|middle|bottom|baseline)$/}},"textarea":{"attributes":["cols","rows","disabled","name","readonly"],"required":["cols","rows"],"inside":"form"},"tfoot":{"attributes":{"align":/^(right|left|center|justify)$/,"0":"char","1":"charoff","valign":/^(top|middle|bottom)$/,"2":"baseline"}},"th":{"attributes":{"0":"abbr","align":/^(left|right|center|justify|char)$/,"1":"axis","2":"char","3":"charoff","colspan":/^(\d)+$/,"4":"headers","rowspan":/^(\d)+$/,"scope":/^(col|colgroup|row|rowgroup)$/,"valign":/^(top|middle|bottom|baseline)$/}},"thead":{"attributes":{"align":/^(right|left|center|justify)$/,"0":"char","1":"charoff","valign":/^(top|middle|bottom|baseline)$/}},"37":"title","tr":{"attributes":{"align":/^(right|left|center|justify|char)$/,"0":"char","1":"charoff","valign":/^(top|middle|bottom|baseline)$/}},"38":"tt","39":"ul","40":"var"},skiped_attributes:[],skiped_attribute_values:[],getValidTagAttributes:function(a,b){var c={};var d=this.getPossibleTagAttributes(a);for(var e in b){var f=b[e];var h=WYMeditor.Helper;if(!h.contains(this.skiped_attributes,e)&&!h.contains(this.skiped_attribute_values,f)){if(typeof f!='function'&&h.contains(d,e)){if(this.doesAttributeNeedsValidation(a,e)){if(this.validateAttribute(a,e,f)){c[e]=f}}else{c[e]=f}}}}return c},getUniqueAttributesAndEventsForTag:function(a){var b=[];if(this._17[a]&&this._17[a]['attributes']){for(k in this._17[a]['attributes']){b.push(parseInt(k)==k?this._17[a]['attributes'][k]:k)}}return b},getDefaultAttributesAndEventsForTags:function(){var a=[];for(var b in this._16){a.push(this._16[b])}for(var b in this._15){a.push(this._15[b])}return a},isValidTag:function(a){if(this._17[a]){return true}for(var b in this._17){if(this._17[b]==a){return true}}return false},getDefaultAttributesAndEventsForTag:function(a){var b=[];if(this.isValidTag(a)){var c=this.getDefaultAttributesAndEventsForTags();for(var d in c){var defaults=c[d];if(typeof defaults=='object'){var h=WYMeditor.Helper;if((defaults['except']&&h.contains(defaults['except'],a))||(defaults['only']&&!h.contains(defaults['only'],a))){continue}var tag_defaults=defaults['attributes']?defaults['attributes']:defaults['events'];for(var k in tag_defaults){b.push(typeof tag_defaults[k]!='string'?k:tag_defaults[k])}}}}return b},doesAttributeNeedsValidation:function(a,b){return this._17[a]&&((this._17[a]['attributes']&&this._17[a]['attributes'][b])||(this._17[a]['required']&&WYMeditor.Helper.contains(this._17[a]['required'],b)))},validateAttribute:function(a,b,c){if(this._17[a]&&(this._17[a]['attributes']&&this._17[a]['attributes'][b]&&c.length>0&&!c.match(this._17[a]['attributes'][b]))||(this._17[a]&&this._17[a]['required']&&WYMeditor.Helper.contains(this._17[a]['required'],b)&&c.length==0)){return false}return typeof this._17[a]!='undefined'},getPossibleTagAttributes:function(a){if(!this._19){this._19={}}if(!this._19[a]){this._19[a]=this.getUniqueAttributesAndEventsForTag(a).concat(this.getDefaultAttributesAndEventsForTag(a))}return this._19[a]}};WYMeditor.ParallelRegex=function(a){this._20=a;this._21=[];this._22=[];this._23=null;return this};WYMeditor.ParallelRegex.prototype.addPattern=function(a,b){b=b||true;var c=this._21.length;this._21[c]=a;this._22[c]=b;this._23=null};WYMeditor.ParallelRegex.prototype.match=function(a){if(this._21.length==0){return[false,'']}var b=a.match(this._24());if(!b){return[false,'']}var c=b[0];for(var i=1;i<b.length;i++){if(b[i]){return[this._22[i-1],c]}}return[true,b[0]]};WYMeditor.ParallelRegex.prototype._24=function(){if(this._23==null){for(var i=0,a=this._21.length;i<a;i++){this._21[i]='('+this._25(this._26(this._21[i]).replace(/([\/\(\)])/g,'\\$1'))+')'}this._23=new RegExp(this._21.join("|"),this._27())}return this._23};WYMeditor.ParallelRegex.prototype._26=function(a){return a.replace(/\(\?(i|m|s|x|U)\)/,'~~~~~~Tk1\$1~~~~~~').replace(/\(\?(\-[i|m|s|x|U])\)/,'~~~~~~Tk2\$1~~~~~~').replace(/\(\?\=(.*)\)/,'~~~~~~Tk3\$1~~~~~~').replace(/\(\?\!(.*)\)/,'~~~~~~Tk4\$1~~~~~~').replace(/\(\?\<\=(.*)\)/,'~~~~~~Tk5\$1~~~~~~').replace(/\(\?\<\!(.*)\)/,'~~~~~~Tk6\$1~~~~~~').replace(/\(\?\:(.*)\)/,'~~~~~~Tk7\$1~~~~~~')};WYMeditor.ParallelRegex.prototype._25=function(a){return a.replace(/~~~~~~Tk1(.{1})~~~~~~/,"(?\$1)").replace(/~~~~~~Tk2(.{2})~~~~~~/,"(?\$1)").replace(/~~~~~~Tk3(.*)~~~~~~/,"(?=\$1)").replace(/~~~~~~Tk4(.*)~~~~~~/,"(?!\$1)").replace(/~~~~~~Tk5(.*)~~~~~~/,"(?<=\$1)").replace(/~~~~~~Tk6(.*)~~~~~~/,"(?<!\$1)").replace(/~~~~~~Tk7(.*)~~~~~~/,"(?:\$1)")};WYMeditor.ParallelRegex.prototype._27=function(){return(this._20?"m":"mi")};WYMeditor.StateStack=function(a){this._28=[a];return this};WYMeditor.StateStack.prototype.getCurrent=function(){return this._28[this._28.length-1]};WYMeditor.StateStack.prototype.enter=function(a){this._28.push(a)};WYMeditor.StateStack.prototype.leave=function(){if(this._28.length==1){return false}this._28.pop();return true};WYMeditor.LEXER_ENTER=1;WYMeditor.LEXER_MATCHED=2;WYMeditor.LEXER_UNMATCHED=3;WYMeditor.LEXER_EXIT=4;WYMeditor.LEXER_SPECIAL=5;WYMeditor.Lexer=function(a,b,c){b=b||'accept';this._20=c||false;this._29={};this._30=a;this._31=new WYMeditor.StateStack(b);this._32={};this._32[b]=b;return this};WYMeditor.Lexer.prototype.addPattern=function(a,b){var b=b||"accept";if(typeof this._29[b]=='undefined'){this._29[b]=new WYMeditor.ParallelRegex(this._20)}this._29[b].addPattern(a);if(typeof this._32[b]=='undefined'){this._32[b]=b}};WYMeditor.Lexer.prototype.addEntryPattern=function(a,b,c){if(typeof this._29[b]=='undefined'){this._29[b]=new WYMeditor.ParallelRegex(this._20)}this._29[b].addPattern(a,c);if(typeof this._32[c]=='undefined'){this._32[c]=c}};WYMeditor.Lexer.prototype.addExitPattern=function(a,b){if(typeof this._29[b]=='undefined'){this._29[b]=new WYMeditor.ParallelRegex(this._20)}this._29[b].addPattern(a,"__exit");if(typeof this._32[b]=='undefined'){this._32[b]=b}};WYMeditor.Lexer.prototype.addSpecialPattern=function(a,b,c){if(typeof this._29[b]=='undefined'){this._29[b]=new WYMeditor.ParallelRegex(this._20)}this._29[b].addPattern(a,'_'+c);if(typeof this._32[c]=='undefined'){this._32[c]=c}};WYMeditor.Lexer.prototype.mapHandler=function(a,b){this._32[a]=b};WYMeditor.Lexer.prototype.parse=function(a){if(typeof this._30=='undefined'){return false}var b=a.length;var c;while(typeof(c=this._33(a))=='object'){var a=c[0];var d=c[1];var e=c[2];var f=c[3];if(!this._34(d,e,f)){return false}if(a==''){return true}if(a.length==b){return false}b=a.length}if(!c){return false}return this._35(a,WYMeditor.LEXER_UNMATCHED)};WYMeditor.Lexer.prototype._34=function(a,b,c){c=c||false;if(!this._35(a,WYMeditor.LEXER_UNMATCHED)){return false}if(typeof c=='boolean'){return this._35(b,WYMeditor.LEXER_MATCHED)}if(this._36(c)){if(!this._35(b,WYMeditor.LEXER_EXIT)){return false}return this._31.leave()}if(this._37(c)){this._31.enter(this._38(c));if(!this._35(b,WYMeditor.LEXER_SPECIAL)){return false}return this._31.leave()}this._31.enter(c);return this._35(b,WYMeditor.LEXER_ENTER)};WYMeditor.Lexer.prototype._36=function(a){return(a==="__exit")};WYMeditor.Lexer.prototype._37=function(a){return(a.substring(0,1)=="_")};WYMeditor.Lexer.prototype._38=function(a){return a.substring(1)};WYMeditor.Lexer.prototype._35=function(a,b){if(!/ +/.test(a)&&((a==='')||(a==false))){return true}var c=this._31.getCurrent();var d=this._32[c];var e;eval('result = this._30.'+d+'(content, is_match);');return e};WYMeditor.Lexer.prototype._33=function(a){var b=this._29[this._31.getCurrent()].match(a);var c=b[1];var d=b[0];if(d){var e=a.indexOf(c);var f=a.substr(0,e);a=a.substring(e+c.length);return[a,f,c,d]}return true};WYMeditor.XhtmlLexer=function(a){jQuery.extend(this,new WYMeditor.Lexer(a,'Text'));this.mapHandler('Text','Text');this.addTokens();this.init();return this};WYMeditor.XhtmlLexer.prototype.init=function(){};WYMeditor.XhtmlLexer.prototype.addTokens=function(){this.addCommentTokens('Text');this.addScriptTokens('Text');this.addCssTokens('Text');this.addTagTokens('Text')};WYMeditor.XhtmlLexer.prototype.addCommentTokens=function(a){this.addEntryPattern("<!--",a,'Comment');this.addExitPattern("-->",'Comment')};WYMeditor.XhtmlLexer.prototype.addScriptTokens=function(a){this.addEntryPattern("<script",a,'Script');this.addExitPattern("</script>",'Script')};WYMeditor.XhtmlLexer.prototype.addCssTokens=function(a){this.addEntryPattern("<style",a,'Css');this.addExitPattern("</style>",'Css')};WYMeditor.XhtmlLexer.prototype.addTagTokens=function(a){this.addSpecialPattern("<\\s*[a-z0-9:\-]+\\s*>",a,'OpeningTag');this.addEntryPattern("<[a-z0-9:\-]+"+'[\\\/ \\\>]+',a,'OpeningTag');this.addInTagDeclarationTokens('OpeningTag');this.addSpecialPattern("</\\s*[a-z0-9:\-]+\\s*>",a,'ClosingTag')};WYMeditor.XhtmlLexer.prototype.addInTagDeclarationTokens=function(a){this.addSpecialPattern('\\s+',a,'Ignore');this.addAttributeTokens(a);this.addExitPattern('/>',a);this.addExitPattern('>',a)};WYMeditor.XhtmlLexer.prototype.addAttributeTokens=function(a){this.addSpecialPattern("\\s*[a-z-_39-9]*:?[a-z-_39-9]+\\s*(?=\=)\\s*",a,'TagAttributes');this.addEntryPattern('=\\s*"',a,'DoubleQuotedAttribute');this.addPattern("\\\\\"",'DoubleQuotedAttribute');this.addExitPattern('"','DoubleQuotedAttribute');this.addEntryPattern("=\\s*'",a,'SingleQuotedAttribute');this.addPattern("\\\\'",'SingleQuotedAttribute');this.addExitPattern("'",'SingleQuotedAttribute');this.addSpecialPattern('=\\s*[^>\\s]*',a,'UnquotedAttribute')};WYMeditor.XhtmlParser=function(a,b){var b=b||'Text';this._40=new WYMeditor.XhtmlLexer(this);this._41=a;this._31=b;this._42=[];this._43='';this._44='';return this};WYMeditor.XhtmlParser.prototype.parse=function(a){this._40.parse(this.beforeParsing(a));return this.afterParsing(this._41.getResult())};WYMeditor.XhtmlParser.prototype.beforeParsing=function(a){if(a.match(/class="MsoNormal"/)||a.match(/ns = "urn:schemas-microsoft-com/)){this._41.avoidStylingTagsAndAttributes()}return this._41.beforeParsing(a)};WYMeditor.XhtmlParser.prototype.afterParsing=function(a){if(this._41._45){this._41.allowStylingTagsAndAttributes()}return this._41.afterParsing(a)};WYMeditor.XhtmlParser.prototype.Ignore=function(a,b){return true};WYMeditor.XhtmlParser.prototype.Text=function(a){this._41.addContent(a);return true};WYMeditor.XhtmlParser.prototype.Comment=function(a,b){return this._46(a,b,'addComment')};WYMeditor.XhtmlParser.prototype.Script=function(a,b){return this._46(a,b,'addScript')};WYMeditor.XhtmlParser.prototype.Css=function(a,b){return this._46(a,b,'addCss')};WYMeditor.XhtmlParser.prototype._46=function(a,b,c){switch(b){case WYMeditor.LEXER_ENTER:this._47=a;break;case WYMeditor.LEXER_UNMATCHED:this._47+=a;break;case WYMeditor.LEXER_EXIT:switch(c){case'addComment':this._41.addComment(this._47+a);break;case'addScript':this._41.addScript(this._47+a);break;case'addCss':this._41.addCss(this._47+a);break}}return true};WYMeditor.XhtmlParser.prototype.OpeningTag=function(a,b){switch(b){case WYMeditor.LEXER_ENTER:this._48=this.normalizeTag(a);this._49={};break;case WYMeditor.LEXER_SPECIAL:this._50(this.normalizeTag(a));break;case WYMeditor.LEXER_EXIT:this._50(this._48,this._49)}return true};WYMeditor.XhtmlParser.prototype.ClosingTag=function(a,b){this._51(this.normalizeTag(a));return true};WYMeditor.XhtmlParser.prototype._50=function(a,b){var b=b||{};this.autoCloseUnclosedBeforeNewOpening(a);if(this._41.isBlockTag(a)){this._41._52.push(a);this._41.fixNestingBeforeOpeningBlockTag(a,b);this._41.openBlockTag(a,b);this._53(a)}else if(this._41.isInlineTag(a)){this._41.inlineTag(a,b)}else{this._41.openUnknownTag(a,b);this._53(a)}this._41.last_tag=a;this._41.last_tag_opened=true;this._41.last_tag_attributes=b};WYMeditor.XhtmlParser.prototype._51=function(a){if(this._54(a)){this.autoCloseUnclosedBeforeTagClosing(a);if(this._41.isBlockTag(a)){var b=this._41._52.pop();if(b==false){return}else if(b!=a){a=b}this._41.closeBlockTag(a)}else{this._41.closeUnknownTag(a)}}else{this._41.closeUnopenedTag(a)}this._41.last_tag=a;this._41.last_tag_opened=false};WYMeditor.XhtmlParser.prototype._53=function(a){this._41._55[a]=this._41._55[a]||0;this._41._55[a]++};WYMeditor.XhtmlParser.prototype._54=function(a){if(this._41._55[a]){this._41._55[a]--;if(this._41._55[a]==0){this._41._55[a]=undefined}return true}return false};WYMeditor.XhtmlParser.prototype.autoCloseUnclosedBeforeNewOpening=function(a){this._56(a,false)};WYMeditor.XhtmlParser.prototype.autoCloseUnclosedBeforeTagClosing=function(a){this._56(a,true)};WYMeditor.XhtmlParser.prototype._56=function(a,b){var b=b||false;if(this._41._55){for(var c in this._41._55){var d=this._41._55[c];if(d>0&&this._41.shouldCloseTagAutomatically(c,a,b)){this._51(c,true)}}}};WYMeditor.XhtmlParser.prototype.getTagReplacements=function(){return this._41.getTagReplacements()};WYMeditor.XhtmlParser.prototype.normalizeTag=function(a){a=a.replace(/^([\s<\/>]*)|([\s<\/>]*)$/gm,'').toLowerCase();var b=this._41.getTagReplacements();if(b[a]){return b[a]}return a};WYMeditor.XhtmlParser.prototype.TagAttributes=function(a,b){if(WYMeditor.LEXER_SPECIAL==b){this._57=a}return true};WYMeditor.XhtmlParser.prototype.DoubleQuotedAttribute=function(a,b){if(WYMeditor.LEXER_UNMATCHED==b){this._49[this._57]=a}return true};WYMeditor.XhtmlParser.prototype.SingleQuotedAttribute=function(a,b){if(WYMeditor.LEXER_UNMATCHED==b){this._49[this._57]=a}return true};WYMeditor.XhtmlParser.prototype.UnquotedAttribute=function(a,b){this._49[this._57]=a.replace(/^=/,'');return true};WYMeditor.XhtmlSaxListener=function(){this.output='';this.helper=new WYMeditor.XmlHelper();this._55={};this.validator=WYMeditor.XhtmlValidator;this._52=[];this.avoided_tags=[];this.entities={'&nbsp;':'&#160;','&iexcl;':'&#161;','&cent;':'&#162;','&pound;':'&#163;','&curren;':'&#164;','&yen;':'&#165;','&brvbar;':'&#166;','&sect;':'&#167;','&uml;':'&#168;','&copy;':'&#169;','&ordf;':'&#170;','&laquo;':'&#171;','&not;':'&#172;','&shy;':'&#173;','&reg;':'&#174;','&macr;':'&#175;','&deg;':'&#176;','&plusmn;':'&#177;','&sup2;':'&#178;','&sup3;':'&#179;','&acute;':'&#180;','&micro;':'&#181;','&para;':'&#182;','&middot;':'&#183;','&cedil;':'&#184;','&sup1;':'&#185;','&ordm;':'&#186;','&raquo;':'&#187;','&frac14;':'&#188;','&frac12;':'&#189;','&frac34;':'&#190;','&iquest;':'&#191;','&Agrave;':'&#192;','&Aacute;':'&#193;','&Acirc;':'&#194;','&Atilde;':'&#195;','&Auml;':'&#196;','&Aring;':'&#197;','&AElig;':'&#198;','&Ccedil;':'&#199;','&Egrave;':'&#200;','&Eacute;':'&#201;','&Ecirc;':'&#202;','&Euml;':'&#203;','&Igrave;':'&#204;','&Iacute;':'&#205;','&Icirc;':'&#206;','&Iuml;':'&#207;','&ETH;':'&#208;','&Ntilde;':'&#209;','&Ograve;':'&#210;','&Oacute;':'&#211;','&Ocirc;':'&#212;','&Otilde;':'&#213;','&Ouml;':'&#214;','&times;':'&#215;','&Oslash;':'&#216;','&Ugrave;':'&#217;','&Uacute;':'&#218;','&Ucirc;':'&#219;','&Uuml;':'&#220;','&Yacute;':'&#221;','&THORN;':'&#222;','&szlig;':'&#223;','&agrave;':'&#224;','&aacute;':'&#225;','&acirc;':'&#226;','&atilde;':'&#227;','&auml;':'&#228;','&aring;':'&#229;','&aelig;':'&#230;','&ccedil;':'&#231;','&egrave;':'&#232;','&eacute;':'&#233;','&ecirc;':'&#234;','&euml;':'&#235;','&igrave;':'&#236;','&iacute;':'&#237;','&icirc;':'&#238;','&iuml;':'&#239;','&eth;':'&#240;','&ntilde;':'&#241;','&ograve;':'&#242;','&oacute;':'&#243;','&ocirc;':'&#244;','&otilde;':'&#245;','&ouml;':'&#246;','&divide;':'&#247;','&oslash;':'&#248;','&ugrave;':'&#249;','&uacute;':'&#250;','&ucirc;':'&#251;','&uuml;':'&#252;','&yacute;':'&#253;','&thorn;':'&#254;','&yuml;':'&#255;','&OElig;':'&#338;','&oelig;':'&#339;','&Scaron;':'&#352;','&scaron;':'&#353;','&Yuml;':'&#376;','&fnof;':'&#402;','&circ;':'&#710;','&tilde;':'&#732;','&Alpha;':'&#913;','&Beta;':'&#914;','&Gamma;':'&#915;','&Delta;':'&#916;','&Epsilon;':'&#917;','&Zeta;':'&#918;','&Eta;':'&#919;','&Theta;':'&#920;','&Iota;':'&#921;','&Kappa;':'&#922;','&Lambda;':'&#923;','&Mu;':'&#924;','&Nu;':'&#925;','&Xi;':'&#926;','&Omicron;':'&#927;','&Pi;':'&#928;','&Rho;':'&#929;','&Sigma;':'&#931;','&Tau;':'&#932;','&Upsilon;':'&#933;','&Phi;':'&#934;','&Chi;':'&#935;','&Psi;':'&#936;','&Omega;':'&#937;','&alpha;':'&#945;','&beta;':'&#946;','&gamma;':'&#947;','&delta;':'&#948;','&epsilon;':'&#949;','&zeta;':'&#950;','&eta;':'&#951;','&theta;':'&#952;','&iota;':'&#953;','&kappa;':'&#954;','&lambda;':'&#955;','&mu;':'&#956;','&nu;':'&#957;','&xi;':'&#958;','&omicron;':'&#959;','&pi;':'&#960;','&rho;':'&#961;','&sigmaf;':'&#962;','&sigma;':'&#963;','&tau;':'&#964;','&upsilon;':'&#965;','&phi;':'&#966;','&chi;':'&#967;','&psi;':'&#968;','&omega;':'&#969;','&thetasym;':'&#977;','&upsih;':'&#978;','&piv;':'&#982;','&ensp;':'&#8194;','&emsp;':'&#8195;','&thinsp;':'&#8201;','&zwnj;':'&#8204;','&zwj;':'&#8205;','&lrm;':'&#8206;','&rlm;':'&#8207;','&ndash;':'&#8211;','&mdash;':'&#8212;','&lsquo;':'&#8216;','&rsquo;':'&#8217;','&sbquo;':'&#8218;','&ldquo;':'&#8220;','&rdquo;':'&#8221;','&bdquo;':'&#8222;','&dagger;':'&#8224;','&Dagger;':'&#8225;','&bull;':'&#8226;','&hellip;':'&#8230;','&permil;':'&#8240;','&prime;':'&#8242;','&Prime;':'&#8243;','&lsaquo;':'&#8249;','&rsaquo;':'&#8250;','&oline;':'&#8254;','&frasl;':'&#8260;','&euro;':'&#8364;','&image;':'&#8465;','&weierp;':'&#8472;','&real;':'&#8476;','&trade;':'&#8482;','&alefsym;':'&#8501;','&larr;':'&#8592;','&uarr;':'&#8593;','&rarr;':'&#8594;','&darr;':'&#8595;','&harr;':'&#8596;','&crarr;':'&#8629;','&lArr;':'&#8656;','&uArr;':'&#8657;','&rArr;':'&#8658;','&dArr;':'&#8659;','&hArr;':'&#8660;','&forall;':'&#8704;','&part;':'&#8706;','&exist;':'&#8707;','&empty;':'&#8709;','&nabla;':'&#8711;','&isin;':'&#8712;','&notin;':'&#8713;','&ni;':'&#8715;','&prod;':'&#8719;','&sum;':'&#8721;','&minus;':'&#8722;','&lowast;':'&#8727;','&radic;':'&#8730;','&prop;':'&#8733;','&infin;':'&#8734;','&ang;':'&#8736;','&and;':'&#8743;','&or;':'&#8744;','&cap;':'&#8745;','&cup;':'&#8746;','&int;':'&#8747;','&there4;':'&#8756;','&sim;':'&#8764;','&cong;':'&#8773;','&asymp;':'&#8776;','&ne;':'&#8800;','&equiv;':'&#8801;','&le;':'&#8804;','&ge;':'&#8805;','&sub;':'&#8834;','&sup;':'&#8835;','&nsub;':'&#8836;','&sube;':'&#8838;','&supe;':'&#8839;','&oplus;':'&#8853;','&otimes;':'&#8855;','&perp;':'&#8869;','&sdot;':'&#8901;','&lceil;':'&#8968;','&rceil;':'&#8969;','&lfloor;':'&#8970;','&rfloor;':'&#8971;','&lang;':'&#9001;','&rang;':'&#9002;','&loz;':'&#9674;','&spades;':'&#9824;','&clubs;':'&#9827;','&hearts;':'&#9829;','&diams;':'&#9830;'};this.block_tags=["a","abbr","acronym","address","area","b","base","bdo","big","blockquote","body","button","caption","cite","code","col","colgroup","dd","del","div","dfn","dl","dt","em","embed","fieldset","form","head","h1","h2","h3","h4","h5","h6","html","i","ins","kbd","label","legend","li","map","noscript","object","ol","optgroup","option","p","param","pre","q","samp","script","select","small","span","strong","style","sub","sup","table","tbody","td","textarea","tfoot","th","thead","title","tr","tt","ul","var","extends"];this.inline_tags=["br","hr","img","input"];return this};WYMeditor.XhtmlSaxListener.prototype.shouldCloseTagAutomatically=function(a,b,c){var c=c||false;if(a=='td'){if((c&&b=='tr')||(!c&&b=='td')){return true}}if(a=='option'){if((c&&b=='select')||(!c&&b=='option')){return true}}return false};WYMeditor.XhtmlSaxListener.prototype.beforeParsing=function(a){this.output='';return a};WYMeditor.XhtmlSaxListener.prototype.afterParsing=function(a){a=this.replaceNamedEntities(a);a=this.joinRepeatedEntities(a);a=this.removeEmptyTags(a);return a};WYMeditor.XhtmlSaxListener.prototype.replaceNamedEntities=function(a){for(var b in this.entities){a=a.replace(b,this.entities[b])}return a};WYMeditor.XhtmlSaxListener.prototype.joinRepeatedEntities=function(a){var b='em|strong|sub|sup|acronym|pre|del|address';return a.replace(new RegExp('<\/('+b+')><\\1>',''),'').replace(new RegExp('(\s*<('+b+')>\s*){2}(.*)(\s*<\/\\2>\s*){2}',''),'<\$2>\$3<\$2>')};WYMeditor.XhtmlSaxListener.prototype.removeEmptyTags=function(a){return a.replace(new RegExp('<('+this.block_tags.join("|").replace(/\|td/,'')+')>(<br \/>|&#160;|&nbsp;|\\s)*<\/\\1>','g'),'')};WYMeditor.XhtmlSaxListener.prototype.getResult=function(){return this.output};WYMeditor.XhtmlSaxListener.prototype.getTagReplacements=function(){return{'b':'strong','i':'em'}};WYMeditor.XhtmlSaxListener.prototype.addContent=function(a){this.output+=a};WYMeditor.XhtmlSaxListener.prototype.addComment=function(a){if(this.remove_comments){this.output+=a}};WYMeditor.XhtmlSaxListener.prototype.addScript=function(a){if(!this.remove_scripts){this.output+=a}};WYMeditor.XhtmlSaxListener.prototype.addCss=function(a){if(!this.remove_embeded_styles){this.output+=a}};WYMeditor.XhtmlSaxListener.prototype.openBlockTag=function(a,b){this.output+=this.helper.tag(a,this.validator.getValidTagAttributes(a,b),true)};WYMeditor.XhtmlSaxListener.prototype.inlineTag=function(a,b){this.output+=this.helper.tag(a,this.validator.getValidTagAttributes(a,b))};WYMeditor.XhtmlSaxListener.prototype.openUnknownTag=function(a,b){};WYMeditor.XhtmlSaxListener.prototype.closeBlockTag=function(a){this.output=this.output.replace(/<br \/>$/,'')+this._58('before',a)+"</"+a+">"+this._58('after',a)};WYMeditor.XhtmlSaxListener.prototype.closeUnknownTag=function(a){};WYMeditor.XhtmlSaxListener.prototype.closeUnopenedTag=function(a){this.output+="</"+a+">"};WYMeditor.XhtmlSaxListener.prototype.avoidStylingTagsAndAttributes=function(){this.avoided_tags=['div','span'];this.validator.skiped_attributes=['style'];this.validator.skiped_attribute_values=['MsoNormal','main1'];this._45=true};WYMeditor.XhtmlSaxListener.prototype.allowStylingTagsAndAttributes=function(){this.avoided_tags=[];this.validator.skiped_attributes=[];this.validator.skiped_attribute_values=[];this._45=false};WYMeditor.XhtmlSaxListener.prototype.isBlockTag=function(a){return!WYMeditor.Helper.contains(this.avoided_tags,a)&&WYMeditor.Helper.contains(this.block_tags,a)};WYMeditor.XhtmlSaxListener.prototype.isInlineTag=function(a){return!WYMeditor.Helper.contains(this.avoided_tags,a)&&WYMeditor.Helper.contains(this.inline_tags,a)};WYMeditor.XhtmlSaxListener.prototype.insertContentAfterClosingTag=function(a,b){this._59('after',a,b)};WYMeditor.XhtmlSaxListener.prototype.insertContentBeforeClosingTag=function(a,b){this._59('before',a,b)};WYMeditor.XhtmlSaxListener.prototype.fixNestingBeforeOpeningBlockTag=function(a,b){if(a!='li'&&(a=='ul'||a=='ol')&&this.last_tag&&!this.last_tag_opened&&this.last_tag=='li'){this.output=this.output.replace(/<\/li>$/,'');this.insertContentAfterClosingTag(a,'</li>')}};WYMeditor.XhtmlSaxListener.prototype._59=function(a,b,c){if(!this['_60'+a+'_61']){this['_60'+a+'_61']=[]}if(!this['_60'+a+'_61'][b]){this['_60'+a+'_61'][b]=[]}this['_60'+a+'_61'][b].push(c)};WYMeditor.XhtmlSaxListener.prototype._58=function(a,b){if(this['_60'+a+'_61']&&this['_60'+a+'_61'][b]&&this['_60'+a+'_61'][b].length>0){return this['_60'+a+'_61'][b].pop()}return''};WYMeditor.WymCssLexer=function(a,b){var b=(typeof b=='undefined'?true:b);jQuery.extend(this,new WYMeditor.Lexer(a,(b?'Ignore':'WymCss')));this.mapHandler('WymCss','Ignore');if(b==true){this.addEntryPattern("/\\\x2a[<\\s]*WYMeditor[>\\s]*\\\x2a/",'Ignore','WymCss');this.addExitPattern("/\\\x2a[<\/\\s]*WYMeditor[>\\s]*\\\x2a/",'WymCss')}this.addSpecialPattern("\\\x2e[a-z-_39-9]+[\\sa-z1-6]*",'WymCss','WymCssStyleDeclaration');this.addEntryPattern("/\\\x2a",'WymCss','WymCssComment');this.addExitPattern("\\\x2a/",'WymCssComment');this.addEntryPattern("\x7b",'WymCss','WymCssStyle');this.addExitPattern("\x7d",'WymCssStyle');this.addEntryPattern("/\\\x2a",'WymCssStyle','WymCssFeddbackStyle');this.addExitPattern("\\\x2a/",'WymCssFeddbackStyle');return this};WYMeditor.WymCssParser=function(){this._62=false;this._63=false;this.only_wym_blocks=true;this.css_settings={'classesItems':[],'editorStyles':[],'dialogStyles':[]};return this};WYMeditor.WymCssParser.prototype.parse=function(a,b){var b=(typeof b=='undefined'?this.only_wym_blocks:b);this._40=new WYMeditor.WymCssLexer(this,b);this._40.parse(a)};WYMeditor.WymCssParser.prototype.Ignore=function(a,b){return true};WYMeditor.WymCssParser.prototype.WymCssComment=function(a,b){if(a.match(/end[a-z0-9\s]*wym[a-z0-9\s]*/mi)){return false}if(b==WYMeditor.LEXER_UNMATCHED){if(!this._62){this._63=true;this._64={'title':WYMeditor.Helper.trim(a)}}else{if(this._64[this._65]){if(!this._64[this._65].expressions){this._64[this._65].expressions=[a]}else{this._64[this._65].expressions.push(a)}}}this._62=true}return true};WYMeditor.WymCssParser.prototype.WymCssStyle=function(a,b){if(b==WYMeditor.LEXER_UNMATCHED){a=WYMeditor.Helper.trim(a);if(a!=''){this._64[this._65].style=a}}else if(b==WYMeditor.LEXER_EXIT){this._62=false;this._63=false;this.addStyleSetting(this._64)}return true};WYMeditor.WymCssParser.prototype.WymCssFeddbackStyle=function(a,b){if(b==WYMeditor.LEXER_UNMATCHED){this._64[this._65].feedback_style=a.replace(/^([\s\/\*]*)|([\s\/\*]*)$/gm,'')}return true};WYMeditor.WymCssParser.prototype.WymCssStyleDeclaration=function(a){a=a.replace(/^([\s\.]*)|([\s\.*]*)$/gm,'');var b='';if(a.indexOf(' ')>0){var c=a.split(' ');this._65=c[0];var b=c[1]}else{this._65=a}if(!this._63){this._64={'title':(!b?'':b.toUpperCase()+': ')+this._65};this._63=true}if(!this._64[this._65]){this._64[this._65]={'name':this._65}}if(b){if(!this._64[this._65].tags){this._64[this._65].tags=[b]}else{this._64[this._65].tags.push(b)}}return true};WYMeditor.WymCssParser.prototype.addStyleSetting=function(a){for(var b in a){var c=a[b];if(typeof c=='object'&&b!='title'){this.css_settings.classesItems.push({'name':WYMeditor.Helper.trim(c.name),'title':a.title,'expr':WYMeditor.Helper.trim((c.expressions||c.tags).join(', '))});if(c.feedback_style){this.css_settings.editorStyles.push({'name':'.'+WYMeditor.Helper.trim(c.name),'css':c.feedback_style})}if(c.style){this.css_settings.dialogStyles.push({'name':'.'+WYMeditor.Helper.trim(c.name),'css':c.style})}}}};jQuery.fn.isPhantomNode=function(){if(this[0].nodeType==3)return!(/[^\t\n\r ]/.test(this[0].data));return false};WYMeditor.isPhantomNode=function(n){if(n.nodeType==3)return!(/[^\t\n\r ]/.test(n.data));return false};WYMeditor.isPhantomString=function(a){return!(/[^\t\n\r ]/.test(a))};jQuery.fn.parentsOrSelf=function(a){var n=this;if(n[0].nodeType==3)n=n.parents().slice(0,1);if(n.filter(a).size()==1)return n;else return n.parents(a).slice(0,1)};WYMeditor.Helper={replaceAll:function(a,b,c){var d=new RegExp(b,"g");return(a.replace(d,c))},insertAt:function(a,b,c){return(a.substr(0,c)+b+a.substring(c))},trim:function(a){return a.replace(/^(\s*)|(\s*)$/gm,'')},contains:function(a,b){for(var i=0;i<a.length;i++){if(a[i]===b)return true}return false},indexOf:function(a,b){var c=-1;for(var i=0;i<a.length;i++){if(a[i]==b){c=i;break}}return(c)},findByName:function(a,b){for(var i=0;i<a.length;i++){var c=a[i];if(c.name==b)return(c)}return(null)}};WYMeditor.WymClassExplorer=function(a){this._9=a;this._8="className";this._10="\r\n"};WYMeditor.WymClassExplorer.prototype.initIframe=function(a){this._11=a;this._5=a.contentWindow.document;var b=this._5.styleSheets[0];var c=eval(this._2.editorStyles);this.addCssRules(this._5,c);this._5.title=this._9._0;jQuery('html',this._5).attr('dir',this._2.direction);jQuery(this._5.body).html(this._9._3);var d=this;this._5.body.onfocus=function(){d._5.designMode="on";d._5=a.contentWindow.document};this._5.onbeforedeactivate=function(){d.saveCaret()};this._5.onkeyup=function(){d.saveCaret();d.keyup()};this._5.onclick=function(){d.saveCaret()};this._5.body.onbeforepaste=function(){d._11.contentWindow.event.returnValue=false};this._5.body.onpaste=function(){d._11.contentWindow.event.returnValue=false;d.paste(window.clipboardData.getData("Text"))};if(this._66){if(jQuery.isFunction(this._2.preBind))this._2.preBind(this);this._9.bindEvents();if(jQuery.isFunction(this._2.postInit))this._2.postInit(this);this.listen()}this._66=true;this._5.designMode="on";try{this._5=a.contentWindow.document}catch(e){}};WYMeditor.WymClassExplorer.prototype._7=function(a,b){switch(a){case WYMeditor.INDENT:case WYMeditor.OUTDENT:var c=this.findUp(this.container(),WYMeditor.LI);if(c)this._5.execCommand(a);break;default:if(b)this._5.execCommand(a,false,b);else this._5.execCommand(a);break}this.listen()};WYMeditor.WymClassExplorer.prototype.selected=function(){var a=this._11.contentWindow.document.caretPos;if(a!=null){if(a.parentElement!=undefined)return(a.parentElement())}};WYMeditor.WymClassExplorer.prototype.saveCaret=function(){this._5.caretPos=this._5.selection.createRange()};WYMeditor.WymClassExplorer.prototype.addCssRule=function(a,b){a.addRule(b.name,b.css)};WYMeditor.WymClassExplorer.prototype.insert=function(a){var b=this._5.selection.createRange();if(jQuery(b.parentElement()).parents(this._2.iframeBodySelector).is('*')){try{b.pasteHTML(a)}catch(e){}}else{this.paste(a)}};WYMeditor.WymClassExplorer.prototype.wrap=function(a,b){var c=this._5.selection.createRange();if(jQuery(c.parentElement()).parents(this._2.iframeBodySelector).is('*')){try{c.pasteHTML(a+c.text+b)}catch(e){}}};WYMeditor.WymClassExplorer.prototype.unwrap=function(){var a=this._5.selection.createRange();if(jQuery(a.parentElement()).parents(this._2.iframeBodySelector).is('*')){try{var b=a.text;this._7('Cut');a.pasteHTML(b)}catch(e){}}};WYMeditor.WymClassExplorer.prototype.keyup=function(){this._6=null};WYMeditor.WymClassExplorer.prototype.setFocusToNode=function(a){var b=this._5.selection.createRange();b.moveToElementText(a);b.collapse(false);b.move('character',-1);b.select();a.focus()};WYMeditor.WymClassMozilla=function(a){this._9=a;this._8="class";this._10="\n"};WYMeditor.WymClassMozilla.prototype.initIframe=function(a){this._11=a;this._5=a.contentDocument;var b=this._5.styleSheets[0];var c=eval(this._2.editorStyles);this.addCssRules(this._5,c);this._5.title=this._9._0;jQuery('html',this._5).attr('dir',this._2.direction);this.html(this._9._3);this.enableDesignMode();if(jQuery.isFunction(this._2.preBind))this._2.preBind(this);this._9.bindEvents();jQuery(this._5).bind("keydown",this.keydown);jQuery(this._5).bind("keyup",this.keyup);jQuery(this._5).bind("focus",this.enableDesignMode);if(jQuery.isFunction(this._2.postInit))this._2.postInit(this);this.listen()};WYMeditor.WymClassMozilla.prototype.html=function(a){if(typeof a==='string'){try{this._5.designMode="off"}catch(e){};a=a.replace(/<em(\b[^>]*)>/gi,"<i$1>").replace(/<\/em>/gi,"</i>").replace(/<strong(\b[^>]*)>/gi,"<b$1>").replace(/<\/strong>/gi,"</b>");jQuery(this._5.body).html(a);this.enableDesignMode()}else return(jQuery(this._5.body).html())};WYMeditor.WymClassMozilla.prototype._7=function(a,b){if(!this.selected())return(false);switch(a){case WYMeditor.INDENT:case WYMeditor.OUTDENT:var c=this.selected();var d=this._11.contentWindow.getSelection();var e=d.anchorNode;if(e.nodeName=="#text")e=e.parentNode;c=this.findUp(c,WYMeditor.BLOCKS);e=this.findUp(e,WYMeditor.BLOCKS);if(c&&c==e&&c.tagName.toLowerCase()==WYMeditor.LI){var f=c.parentNode.parentNode;if(c.parentNode.childNodes.length>1||f.tagName.toLowerCase()==WYMeditor.OL||f.tagName.toLowerCase()==WYMeditor.UL)this._5.execCommand(a,'',null)}break;default:if(b)this._5.execCommand(a,'',b);else this._5.execCommand(a,'',null)}var g=this.selected();if(g.tagName.toLowerCase()==WYMeditor.BODY)this._7(WYMeditor.FORMAT_BLOCK,WYMeditor.P);this.listen()};WYMeditor.WymClassMozilla.prototype.selected=function(){var a=this._11.contentWindow.getSelection();var b=a.focusNode;if(b){if(b.nodeName=="#text")return(b.parentNode);else return(b)}else return(null)};WYMeditor.WymClassMozilla.prototype.addCssRule=function(a,b){a.insertRule(b.name+" {"+b.css+"}",a.cssRules.length)};WYMeditor.WymClassMozilla.prototype.keydown=function(a){var b=WYMeditor.INSTANCES[this.title];if(a.ctrlKey){if(a.keyCode==66){b._7(WYMeditor.BOLD);return false}if(a.keyCode==73){b._7(WYMeditor.ITALIC);return false}}};WYMeditor.WymClassMozilla.prototype.keyup=function(a){var b=WYMeditor.INSTANCES[this.title];b._6=null;var c=null;if(a.keyCode==13&&!a.shiftKey){jQuery(b._5.body).children(WYMeditor.BR).remove();c=b.selected();if(c&&c.tagName.toLowerCase()==WYMeditor.PRE)b._7(WYMeditor.FORMAT_BLOCK,WYMeditor.P)}else if(a.keyCode!=8&&a.keyCode!=17&&a.keyCode!=46&&a.keyCode!=224&&!a.metaKey&&!a.ctrlKey){c=b.selected();var d=c.tagName.toLowerCase();if(d=="strong"||d=="b"||d=="em"||d=="i"||d=="sub"||d=="sup"||d=="a")d=c.parentNode.tagName.toLowerCase();if(d==WYMeditor.BODY)b._7(WYMeditor.FORMAT_BLOCK,WYMeditor.P)}};WYMeditor.WymClassMozilla.prototype.enableDesignMode=function(){if(this.designMode=="off"){try{this.designMode="on";this.execCommand("styleWithCSS",'',false)}catch(e){}}};WYMeditor.WymClassMozilla.prototype.setFocusToNode=function(a){var b=document.createRange();b.selectNode(a);var c=this._11.contentWindow.getSelection();c.addRange(b);c.collapse(a,a.childNodes.length);this._11.contentWindow.focus()};WYMeditor.WymClassMozilla.prototype.openBlockTag=function(a,b){var b=this.validator.getValidTagAttributes(a,b);if(a=='span'&&b.style){var c=this.getTagForStyle(b.style);if(c){this._52.pop();var a=c;this._52.push(c);b.style=''}else{return}}this.output+=this.helper.tag(a,b,true)};WYMeditor.WymClassMozilla.prototype.getTagForStyle=function(a){if(/bold/.test(a))return'strong';if(/italic/.test(a))return'em';if(/sub/.test(a))return'sub';if(/sub/.test(a))return'super';return false};WYMeditor.WymClassOpera=function(a){this._9=a;this._8="class";this._10="\r\n"};WYMeditor.WymClassOpera.prototype.initIframe=function(a){this._11=a;this._5=a.contentWindow.document;var b=this._5.styleSheets[0];var c=eval(this._2.editorStyles);this.addCssRules(this._5,c);this._5.title=this._9._0;jQuery('html',this._5).attr('dir',this._2.direction);this._5.designMode="on";this.html(this._9._3);if(jQuery.isFunction(this._2.preBind))this._2.preBind(this);this._9.bindEvents();jQuery(this._5).bind("keydown",this.keydown);jQuery(this._5).bind("keyup",this.keyup);if(jQuery.isFunction(this._2.postInit))this._2.postInit(this);this.listen()};WYMeditor.WymClassOpera.prototype._7=function(a,b){if(b)this._5.execCommand(a,false,b);else this._5.execCommand(a);this.listen()};WYMeditor.WymClassOpera.prototype.selected=function(){var a=this._11.contentWindow.getSelection();var b=a.focusNode;if(b){if(b.nodeName=="#text")return(b.parentNode);else return(b)}else return(null)};WYMeditor.WymClassOpera.prototype.addCssRule=function(a,b){a.insertRule(b.name+" {"+b.css+"}",a.cssRules.length)};WYMeditor.WymClassOpera.prototype.keydown=function(a){var b=WYMeditor.INSTANCES[this.title];var c=b._11.contentWindow.getSelection();startNode=c.getRangeAt(0).startContainer;if(!jQuery(startNode).parentsOrSelf(WYMeditor.MAIN_CONTAINERS.join(","))[0]&&!jQuery(startNode).parentsOrSelf('li')&&a.keyCode!=WYMeditor.KEY.ENTER&&a.keyCode!=WYMeditor.KEY.LEFT&&a.keyCode!=WYMeditor.KEY.UP&&a.keyCode!=WYMeditor.KEY.RIGHT&&a.keyCode!=WYMeditor.KEY.DOWN&&a.keyCode!=WYMeditor.KEY.BACKSPACE&&a.keyCode!=WYMeditor.KEY.DELETE)b._7(WYMeditor.FORMAT_BLOCK,WYMeditor.P)};WYMeditor.WymClassOpera.prototype.keyup=function(a){var b=WYMeditor.INSTANCES[this.title];b._6=null};WYMeditor.WymClassOpera.prototype.setFocusToNode=function(a){};WYMeditor.WymClassSafari=function(a){this._9=a;this._8="class";this._10="\n"};WYMeditor.WymClassSafari.prototype.initIframe=function(a){this._11=a;this._5=a.contentDocument;var b=this._5.styleSheets[0];var c=eval(this._2.editorStyles);this.addCssRules(this._5,c);this._5.title=this._9._0;jQuery('html',this._5).attr('dir',this._2.direction);this._5.designMode="on";this.html(this._9._3);if(jQuery.isFunction(this._2.preBind))this._2.preBind(this);this._9.bindEvents();jQuery(this._5).bind("keydown",this.keydown);jQuery(this._5).bind("keyup",this.keyup);if(jQuery.isFunction(this._2.postInit))this._2.postInit(this);this.listen()};WYMeditor.WymClassSafari.prototype._7=function(a,b){if(!this.selected())return(false);switch(a){case WYMeditor.INDENT:case WYMeditor.OUTDENT:var c=this.selected();var d=this._11.contentWindow.getSelection();var e=d.anchorNode;if(e.nodeName=="#text")e=e.parentNode;c=this.findUp(c,WYMeditor.BLOCKS);e=this.findUp(e,WYMeditor.BLOCKS);if(c&&c==e&&c.tagName.toLowerCase()==WYMeditor.LI){var f=c.parentNode.parentNode;if(c.parentNode.childNodes.length>1||f.tagName.toLowerCase()==WYMeditor.OL||f.tagName.toLowerCase()==WYMeditor.UL)this._5.execCommand(a,'',null)}break;case WYMeditor.INSERT_ORDEREDLIST:case WYMeditor.INSERT_UNORDEREDLIST:this._5.execCommand(a,'',null);var c=this.selected();var g=this.findUp(c,WYMeditor.MAIN_CONTAINERS);if(g)jQuery(g).replaceWith(jQuery(g).html());break;default:if(b)this._5.execCommand(a,'',b);else this._5.execCommand(a,'',null)}var g=this.selected();if(g&&g.tagName.toLowerCase()==WYMeditor.BODY)this._7(WYMeditor.FORMAT_BLOCK,WYMeditor.P);this.listen()};WYMeditor.WymClassSafari.prototype.selected=function(){var a=this._11.contentWindow.getSelection();var b=a.focusNode;if(b){if(b.nodeName=="#text")return(b.parentNode);else return(b)}else return(null)};WYMeditor.WymClassSafari.prototype.addCssRule=function(a,b){a.insertRule(b.name+" {"+b.css+"}",a.cssRules.length)};WYMeditor.WymClassSafari.prototype.keydown=function(a){var b=WYMeditor.INSTANCES[this.title];if(a.ctrlKey){if(a.keyCode==66){b._7(WYMeditor.BOLD);return false}if(a.keyCode==73){b._7(WYMeditor.ITALIC);return false}}};WYMeditor.WymClassSafari.prototype.keyup=function(a){var b=WYMeditor.INSTANCES[this.title];b._6=null;var c=null;if(a.keyCode==13&&!a.shiftKey){jQuery(b._5.body).children(WYMeditor.BR).remove();c=b.selected();if(c&&c.tagName.toLowerCase()==WYMeditor.PRE)b._7(WYMeditor.FORMAT_BLOCK,WYMeditor.P)}if(a.keyCode==13&&a.shiftKey){b._7('InsertLineBreak')}if(a.keyCode!=8&&a.keyCode!=17&&a.keyCode!=46&&a.keyCode!=224&&!a.metaKey&&!a.ctrlKey){c=b.selected();var d=c.tagName.toLowerCase();if(d=="strong"||d=="b"||d=="em"||d=="i"||d=="sub"||d=="sup"||d=="a"||d=="span")d=c.parentNode.tagName.toLowerCase();if(d==WYMeditor.BODY||d==WYMeditor.DIV)b._7(WYMeditor.FORMAT_BLOCK,WYMeditor.P)}};WYMeditor.WymClassSafari.prototype.setFocusToNode=function(a){};WYMeditor.WymClassSafari.prototype.openBlockTag=function(a,b){var b=this.validator.getValidTagAttributes(a,b);if(a=='span'&&b.style){var c=this.getTagForStyle(b.style);if(c){this._52.pop();var a=c;this._52.push(c);b.style='';if(typeof b['class']=='string')b['class']=b['class'].replace(/apple-style-span/gi,'')}else{return}}this.output+=this.helper.tag(a,b,true)};WYMeditor.WymClassSafari.prototype.getTagForStyle=function(a){if(/bold/.test(a))return'strong';if(/italic/.test(a))return'em';if(/sub/.test(a))return'sub';if(/super/.test(a))return'sup';return false};
